<!DOCTYPE html>
<!-- saved from url=(0093)file:///C:/Users/HxTos/Desktop/Port%20Automation/HXtos%20CY/CY%20Cntr%20Inspect%205Light.html -->
<html lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>CY | Inspect &amp; Avarias (White UI)</title>
  <style>
    :root{
      /* WHITE UI */
      --bg:#ffffff;
      --panel:#ffffff;
      --text:#0f172a;       /* slate-900 */
      --muted:#475569;      /* slate-600 */
      --muted2:#64748b;     /* slate-500 */
      --line:rgba(15,23,42,.12);

      /* Accent (blue/green) */
      --blue:#2563eb;       /* blue-600 */
      --green:#10b981;      /* emerald-500 */

      --btn:#0f172a;
      --btnText:#ffffff;

      --ok:#16a34a;
      --warn:#d97706;
      --bad:#dc2626;
      --info:#2563eb;

      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:var(--bg);         /* branco */
      height:100vh;
      overflow:hidden;
    }

    .app{display:grid; grid-template-columns:260px 1fr; height:100%;}
    .sidebar{
      background:var(--panel);      /* branco */
      border-right:1px solid var(--line);
      padding:14px;
      overflow:auto;
    }

    .brand{
      display:flex; align-items:center; gap:10px;
      padding:12px;
      border:1px solid var(--line);
      border-radius:16px;
      background:#fff;              /* branco */
      margin-bottom:12px;
    }
    .logo{
      width:34px; height:34px; border-radius:10px; display:grid; place-items:center;
      background:linear-gradient(135deg, var(--blue), var(--green));
      color:#fff;
      font-weight:900;
    }
    .brand .t1{font-weight:900; font-size:14px;}
    .brand .t2{color:var(--muted2); font-size:12px; margin-top:2px;}

    .nav a{
      display:flex; align-items:center; gap:10px;
      padding:10px 12px;
      border-radius:12px;
      color:rgba(15,23,42,.88);
      text-decoration:none;
      border:1px solid transparent;
      cursor:pointer;
    }
    .nav a:hover{
      background:rgba(37,99,235,.06);
      border-color:rgba(37,99,235,.15);
    }
    .nav a.active{
      background:rgba(37,99,235,.10);
      border-color:rgba(37,99,235,.25);
    }

    .main{padding:16px; overflow:auto; background:#fff;} /* branco */
    .top{
      display:flex; justify-content:space-between; align-items:flex-start; gap:12px;
      margin-bottom:12px;
    }
    h1{margin:0; font-size:18px;}
    .sub{margin-top:4px; color:var(--muted); font-size:12px;}

    .btn{
      border:1px solid rgba(15,23,42,.18);
      background:#fff;
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:800;
      font-size:13px;
    }
    .btn:hover{background:rgba(15,23,42,.03);}
    .btn.primary{
      background:var(--blue);
      border-color:rgba(37,99,235,.35);
      color:#fff;
    }
    .btn.primary:hover{filter:brightness(.95);}

    .grid{display:grid; grid-template-columns: 1.1fr .9fr; gap:12px;}

    .card{
      border:1px solid var(--line);
      background:#fff; /* branco */
      border-radius:18px;
      overflow:hidden;
      box-shadow:0 1px 0 rgba(15,23,42,.04);
    }
    .card h2{
      margin:0;
      padding:12px 12px;
      font-size:13px;
      letter-spacing:.2px;
      border-bottom:1px solid var(--line);
      background:#fff;  /* sem ‚Äútinta‚Äù */
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .body{padding:12px;}

    label{display:block; font-size:12px; color:rgba(51,65,85,.95); margin:10px 0 6px;}
    input, select, textarea{
      width:100%;
      border:1px solid rgba(15,23,42,.16);
      background:#fff;
      color:var(--text);
      border-radius:12px;
      padding:10px 11px;
      outline:none;
      font-size:13px;
    }
    input:focus, select:focus, textarea:focus{
      border-color:rgba(37,99,235,.55);
      box-shadow:0 0 0 3px rgba(37,99,235,.12);
    }
    textarea{min-height:90px; resize:vertical;}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:10px;}

    .hint{
      margin-top:10px;
      font-size:12px;
      color:var(--muted);
      line-height:1.35;
    }

    .tag{
      display:inline-flex; align-items:center; gap:6px;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(15,23,42,.16);
      background:#fff;
      font-size:11px;
      color:rgba(15,23,42,.78);
      white-space:nowrap;
    }
    .dot{width:7px;height:7px;border-radius:50%;}
    .ok .dot{background:var(--ok)}
    .warn .dot{background:var(--warn)}
    .bad .dot{background:var(--bad)}
    .info .dot{background:var(--info)}

    .list{
      border:1px solid var(--line);
      border-radius:14px;
      overflow:hidden;
      background:#fff;
    }
    .list .item{
      display:grid;
      grid-template-columns:1fr auto;
      gap:10px;
      padding:10px 10px;
      border-top:1px solid rgba(15,23,42,.08);
      cursor:pointer;
      background:#fff;
    }
    .list .item:first-child{border-top:none;}
    .list .item:hover{background:rgba(37,99,235,.06);}
    .mono{font-family:var(--mono)}
    .actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;}

    .uploadBox{
      border:1px dashed rgba(15,23,42,.22);
      border-radius:14px;
      padding:10px;
      background:#fff; /* branco, sem azul */
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .uploadBox small{color:var(--muted2)}
    .chips{display:flex; flex-wrap:wrap; gap:8px; margin-top:10px;}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(15,23,42,.16);
      background:#fff;
      cursor:pointer;
      font-size:12px;
    }
    .chip:hover{background:rgba(15,23,42,.03)}
    .chip .x{opacity:.75; font-weight:900}

    .page{display:none;}
    .page.active{display:block;}

    @media (max-width: 980px){
      .app{grid-template-columns:1fr;}
      .sidebar{border-right:none; border-bottom:1px solid var(--line);}
      .grid{grid-template-columns:1fr;}
      .row{grid-template-columns:1fr;}
    }
  </style>
</head>

<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo">CY</div>
        <div>
          <div class="t1">Inspect &amp; Avarias</div>
          <div class="t2">White UI ‚Ä¢ Azul/Verde (detalhes)</div>
        </div>
      </div>

      <nav class="nav" id="nav">
        <a data-page="inspect" class="active">üîç Inspect
          <span style="margin-left:auto" class="tag info"><span class="dot"></span><span id="pillInspect">1</span></span>
        </a>
        <a data-page="avarias" class="">üõ†Ô∏è Avarias
          <span style="margin-left:auto" class="tag warn"><span class="dot"></span><span id="pillAvarias">0</span></span>
        </a>
        <a data-page="relatorios" class="">üìÅ Relat√≥rios</a>
      </nav>

      <div class="hint" style="margin-top:12px;">
        Dados persistidos no navegador (demo local).
      </div>
    </aside>

    <main class="main">
      <div class="top">
        <div>
          <h1 id="pageTitle">CY | Inspect</h1>
          <div class="sub" id="pageSub">Registrar inspe√ß√£o e gerar avaria.</div>
        </div>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button class="btn" id="seed">üß™ Popular demo</button>
          <button class="btn" id="reset">‚ôªÔ∏è Reset</button>
        </div>
      </div>

      <!-- INSPECT -->
      <section class="page active" id="page-inspect">
        <div class="grid">
          <section class="card">
            <h2>
              <span>Registro de Inspe√ß√£o</span>
              <span class="tag info"><span class="dot"></span><span class="mono">INSP</span></span>
            </h2>
            <div class="body">
              <div class="row">
                <div>
                  <label>CNTR</label>
                  <input id="i_cntr" placeholder="ABCD1234567">
                </div>
                <div>
                  <label>Tipo</label>
                  <select id="i_tipo">
                    <option>GATE IN</option>
                    <option>GATE OUT</option>
                    <option>P√ÅTIO</option>
                    <option>TRANSFER√äNCIA</option>
                  </select>
                </div>
              </div>

              <div class="row">
                <div>
                  <label>V√≠nculo (BL/CE/OS)</label>
                  <input id="i_vinc" placeholder="CE 2026/000123 | BL: ...">
                </div>
                <div>
                  <label>Respons√°vel</label>
                  <input id="i_resp" placeholder="Inspetor 01">
                </div>
              </div>

              <div class="row">
                <div>
                  <label>Severidade</label>
                  <select id="i_sev">
                    <option>BAIXA</option>
                    <option>M√âDIA</option>
                    <option>ALTA</option>
                    <option>CR√çTICA</option>
                  </select>
                </div>
                <div>
                  <label>Status</label>
                  <select id="i_status">
                    <option>RASCUNHO</option>
                    <option>EM AN√ÅLISE</option>
                    <option>ENCERRADA</option>
                  </select>
                </div>
              </div>

              <label>Descri√ß√£o / Observa√ß√µes</label>
              <textarea id="i_desc" placeholder="Resumo: √°rea, tipo de dano, risco e decis√£o operacional."></textarea>

              <div class="actions">
                <button class="btn primary" id="i_save">üíæ Salvar inspe√ß√£o</button>
                <button class="btn" id="i_gen">üõ†Ô∏è Gerar avaria</button>
                <button class="btn" id="i_new">‚ûï Nova</button>
              </div>
            </div>
          </section>

          <section class="card">
            <h2>
              <span>Inspe√ß√µes Recentes</span>
              <span class="tag"><span class="dot" style="background:rgba(15,23,42,.35)"></span>clique para ver</span>
            </h2>
            <div class="body">
              <div class="row">
                <div>
                  <label>Filtro CNTR</label>
                  <input id="i_fcntr" placeholder="ABCD...">
                </div>
                <div>
                  <label>Filtro Status</label>
                  <select id="i_fstatus">
                    <option value="">Todos</option>
                    <option>RASCUNHO</option>
                    <option>EM AN√ÅLISE</option>
                    <option>ENCERRADA</option>
                  </select>
                </div>
              </div>

              <div class="actions" style="margin-top:10px;">
                <button class="btn" id="i_apply">üîé Aplicar</button>
                <button class="btn" id="i_clear">üßπ Limpar</button>
              </div>

              <div style="margin-top:12px;" class="list" id="i_list">
        <div class="item" data-id="INSP-20260105-162832">
          <div>
            <div><b>MSCU3452345</b> <span class="mono" style="opacity:.70">‚Ä¢ INSP-20260105-162832</span></div>
            <div style="margin-top:6px; display:flex; gap:8px; flex-wrap:wrap;">
              <span class="tag ok"><span class="dot"></span>BAIXA</span> <span class="tag info"><span class="dot"></span>ENCERRADA</span>
              <span class="tag"><span class="dot" style="background:rgba(15,23,42,.35)"></span>GATE IN</span>
            </div>
          </div>
          <div class="mono" style="opacity:.60">05/01/2026 16:28</div>
        </div></div>
            </div>
          </section>
        </div>
      </section>

      <!-- AVARIAS -->
      <section class="page" id="page-avarias">
        <div class="grid">
          <section class="card">
            <h2>
              <span>Registro de Avaria</span>
              <span class="tag warn"><span class="dot"></span><span class="mono">AVA</span></span>
            </h2>
            <div class="body">
              <div class="row">
                <div>
                  <label>CNTR</label>
                  <input id="a_cntr" placeholder="ABCD1234567">
                </div>
                <div>
                  <label>Origem</label>
                  <select id="a_origem">
                    <option>VISTORIA</option>
                    <option>GATE</option>
                    <option>P√ÅTIO</option>
                    <option>EQUIPAMENTO</option>
                    <option>TERCEIRO</option>
                  </select>
                </div>
              </div>

              <div class="row">
                <div>
                  <label>Severidade</label>
                  <select id="a_sev">
                    <option>BAIXA</option>
                    <option>M√âDIA</option>
                    <option>ALTA</option>
                    <option>CR√çTICA</option>
                  </select>
                </div>
                <div>
                  <label>Status</label>
                  <select id="a_status">
                    <option>ABERTA</option>
                    <option>EM AN√ÅLISE</option>
                    <option>EM REPARO</option>
                    <option>ENCERRADA</option>
                  </select>
                </div>
              </div>

              <div class="row">
                <div>
                  <label>√Årea</label>
                  <select id="a_area">
                    <option>PORTAS</option>
                    <option>LATERAL ESQ</option>
                    <option>LATERAL DIR</option>
                    <option>FRENTE</option>
                    <option>TETO</option>
                    <option>PISO</option>
                    <option>CANTONEIRAS</option>
                  </select>
                </div>
                <div>
                  <label>Tipo</label>
                  <select id="a_tipo">
                    <option>AMASSADO</option>
                    <option>CORTE / PERFURA√á√ÉO</option>
                    <option>FERRUGEM</option>
                    <option>TRINCA</option>
                    <option>DESALINHAMENTO</option>
                    <option>OUTRA</option>
                  </select>
                </div>
              </div>

              <label>Descri√ß√£o / Decis√£o</label>
              <textarea id="a_desc" placeholder="Descreva a avaria e decis√£o: hold, repair, libera√ß√£o etc."></textarea>

              <label>Fotos / Evid√™ncias</label>
              <div class="uploadBox">
                <div>
                  <div style="font-weight:900;">üì∑ Anexar fotos</div>
                  <small>Demo: salva apenas o nome do arquivo.</small>
                </div>
                <input id="a_files" type="file" multiple="" accept="image/*">
              </div>
              <div class="chips" id="a_chips"><span class="tag"><span class="dot" style="background:rgba(15,23,42,.35)"></span>sem fotos</span></div>

              <div class="actions">
                <button class="btn primary" id="a_save">üíæ Salvar avaria</button>
                <button class="btn" id="a_new">‚ûï Nova</button>
              </div>
            </div>
          </section>

          <section class="card">
            <h2>
              <span>Avarias Recentes</span>
              <span class="tag"><span class="dot" style="background:rgba(15,23,42,.35)"></span>clique para ver</span>
            </h2>
            <div class="body">
              <div class="row">
                <div>
                  <label>Filtro CNTR</label>
                  <input id="a_fcntr" placeholder="ABCD...">
                </div>
                <div>
                  <label>Filtro Status</label>
                  <select id="a_fstatus">
                    <option value="">Todos</option>
                    <option>ABERTA</option>
                    <option>EM AN√ÅLISE</option>
                    <option>EM REPARO</option>
                    <option>ENCERRADA</option>
                  </select>
                </div>
              </div>

              <div class="row">
                <div>
                  <label>Filtro Severidade</label>
                  <select id="a_fsev">
                    <option value="">Todas</option>
                    <option>BAIXA</option>
                    <option>M√âDIA</option>
                    <option>ALTA</option>
                    <option>CR√çTICA</option>
                  </select>
                </div>
                <div>
                  <label>Filtro Origem</label>
                  <select id="a_forigem">
                    <option value="">Todas</option>
                    <option>VISTORIA</option>
                    <option>GATE</option>
                    <option>P√ÅTIO</option>
                    <option>EQUIPAMENTO</option>
                    <option>TERCEIRO</option>
                  </select>
                </div>
              </div>

              <div class="actions" style="margin-top:10px;">
                <button class="btn" id="a_apply">üîé Aplicar</button>
                <button class="btn" id="a_clear">üßπ Limpar</button>
              </div>

              <div style="margin-top:12px;" class="list" id="a_list"><div class="item" style="cursor:default"><div style="color:rgba(71,85,105,.95)">Nenhum registro.</div><div class="mono">‚Äî</div></div></div>
            </div>
          </section>
        </div>
      </section>

      <!-- RELATORIOS -->
      <section class="page" id="page-relatorios">
        <div class="card">
          <h2>Relat√≥rios (placeholder)</h2>
          <div class="body">
            <div class="hint">Espa√ßo para KPIs e exporta√ß√µes (CSV/PDF) em uma pr√≥xima itera√ß√£o.</div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    const KEY="CY_INSPECT_AVARIAS_WHITE_UI_v1";
    const $=(q)=>document.querySelector(q);
    const $$=(q)=>Array.from(document.querySelectorAll(q));
    let S=load();

    function load(){
      try{
        const raw=localStorage.getItem(KEY);
        return raw ? Object.assign({inspections:[],damages:[]}, JSON.parse(raw)) : {inspections:[],damages:[]};
      }catch(e){ return {inspections:[],damages:[]}; }
    }
    function persist(){
      localStorage.setItem(KEY, JSON.stringify(S));
      $("#pillInspect").textContent=S.inspections.length;
      $("#pillAvarias").textContent=S.damages.length;
    }
    function uid(prefix){
      const d=new Date(); const p=n=>String(n).padStart(2,"0");
      return `${prefix}-${d.getFullYear()}${p(d.getMonth()+1)}${p(d.getDate())}-${p(d.getHours())}${p(d.getMinutes())}${p(d.getSeconds())}`;
    }
    function fmt(iso){
      const d=new Date(iso); const p=n=>String(n).padStart(2,"0");
      return `${p(d.getDate())}/${p(d.getMonth()+1)}/${d.getFullYear()} ${p(d.getHours())}:${p(d.getMinutes())}`;
    }
    function tagSev(sev){
      const cls=sev==="BAIXA"?"ok":(sev==="M√âDIA"?"warn":"bad");
      return `<span class="tag ${cls}"><span class="dot"></span>${sev}</span>`;
    }
    function tagStatus(status){return `<span class="tag info"><span class="dot"></span>${status}</span>`;}

    function setPage(page){
      $$(".page").forEach(p=>p.classList.remove("active"));
      $("#page-"+page).classList.add("active");
      $$("#nav a").forEach(a=>a.classList.remove("active"));
      $(`#nav a[data-page="${page}"]`).classList.add("active");

      const meta={
        inspect:["CY | Inspect","Registrar inspe√ß√£o e gerar avaria."],
        avarias:["CY | Avarias","Registrar avaria com fotos/evid√™ncias e consultar lista."],
        relatorios:["CY | Relat√≥rios","Placeholder para KPIs/exporta√ß√µes."]
      };
      $("#pageTitle").textContent=meta[page][0];
      $("#pageSub").textContent=meta[page][1];
      if(page==="inspect") renderInspect();
      if(page==="avarias") renderAvarias();
    }
    $$("#nav a").forEach(a=>a.addEventListener("click",()=>setPage(a.getAttribute("data-page"))));

    // Inspect
    function resetInspect(){
      $("#i_cntr").value=""; $("#i_tipo").value="GATE IN"; $("#i_vinc").value="";
      $("#i_resp").value=""; $("#i_sev").value="BAIXA"; $("#i_status").value="RASCUNHO"; $("#i_desc").value="";
    }
    function saveInspect(){
      const cntr=$("#i_cntr").value.trim().toUpperCase();
      if(!cntr){ alert("Informe o CNTR."); return; }
      S.inspections.unshift({
        id:uid("INSP"), cntr, tipo:$("#i_tipo").value, vinc:$("#i_vinc").value.trim(),
        resp:$("#i_resp").value.trim(), sev:$("#i_sev").value, status:$("#i_status").value,
        desc:$("#i_desc").value.trim(), createdAt:new Date().toISOString()
      });
      persist(); renderInspect(); resetInspect(); alert("Inspe√ß√£o salva (demo).");
    }
    function renderInspect(){
      const fcntr=$("#i_fcntr").value.trim().toUpperCase();
      const fstatus=$("#i_fstatus").value;

      const list=S.inspections
        .filter(x=>!fcntr||x.cntr.includes(fcntr))
        .filter(x=>!fstatus||x.status===fstatus)
        .sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt));

      const el=$("#i_list");
      if(!list.length){
        el.innerHTML=`<div class="item" style="cursor:default"><div style="color:rgba(71,85,105,.95)">Nenhum registro.</div><div class="mono">‚Äî</div></div>`;
        return;
      }
      el.innerHTML=list.map(x=>`
        <div class="item" data-id="${x.id}">
          <div>
            <div><b>${x.cntr}</b> <span class="mono" style="opacity:.70">‚Ä¢ ${x.id}</span></div>
            <div style="margin-top:6px; display:flex; gap:8px; flex-wrap:wrap;">
              ${tagSev(x.sev)} ${tagStatus(x.status)}
              <span class="tag"><span class="dot" style="background:rgba(15,23,42,.35)"></span>${x.tipo}</span>
            </div>
          </div>
          <div class="mono" style="opacity:.60">${fmt(x.createdAt)}</div>
        </div>`).join("");

      el.querySelectorAll(".item[data-id]").forEach(r=>r.addEventListener("click",()=>{
        const x=S.inspections.find(z=>z.id===r.getAttribute("data-id"));
        alert(
          `Inspe√ß√£o ${x.id}\nCNTR: ${x.cntr}\nTipo: ${x.tipo}\nStatus: ${x.status}\nSeveridade: ${x.sev}\n` +
          `V√≠nculo: ${x.vinc || "‚Äî"}\nResp: ${x.resp || "‚Äî"}\n\nDescri√ß√£o:\n${x.desc || "‚Äî"}`
        );
      }));
    }
    function genAvariaFromInspect(){
      const cntr=$("#i_cntr").value.trim().toUpperCase();
      if(!cntr){ alert("Informe o CNTR antes de gerar avaria."); return; }
      setPage("avarias");
      $("#a_cntr").value=cntr;
      $("#a_origem").value="VISTORIA";
      $("#a_sev").value=$("#i_sev").value;
      $("#a_status").value="ABERTA";
      $("#a_area").value="PORTAS";
      $("#a_tipo").value=(($("#i_sev").value==="CR√çTICA"||$("#i_sev").value==="ALTA") ? "DESALINHAMENTO" : "AMASSADO");
      $("#a_desc").value=`Gerado a partir de Inspect. Observa√ß√µes: ${($("#i_desc").value||"‚Äî")}`;
      avDraftPhotos=[]; renderChips();
    }
    $("#i_save").addEventListener("click", saveInspect);
    $("#i_gen").addEventListener("click", genAvariaFromInspect);
    $("#i_new").addEventListener("click", resetInspect);
    $("#i_apply").addEventListener("click", renderInspect);
    $("#i_clear").addEventListener("click", ()=>{ $("#i_fcntr").value=""; $("#i_fstatus").value=""; renderInspect(); });

    // Avarias (with photos)
    let avDraftPhotos=[];
    function renderChips(){
      const el=$("#a_chips"); el.innerHTML="";
      if(!avDraftPhotos.length){
        el.innerHTML=`<span class="tag"><span class="dot" style="background:rgba(15,23,42,.35)"></span>sem fotos</span>`;
        return;
      }
      avDraftPhotos.forEach(name=>{
        const chip=document.createElement("span");
        chip.className="chip";
        chip.innerHTML=`üì∑ ${name} <span class="x">‚úï</span>`;
        chip.title="Clique para remover";
        chip.addEventListener("click",()=>{ avDraftPhotos=avDraftPhotos.filter(n=>n!==name); renderChips(); });
        el.appendChild(chip);
      });
    }
    $("#a_files").addEventListener("change",(e)=>{
      Array.from(e.target.files||[]).forEach(f=>{ if(!avDraftPhotos.includes(f.name)) avDraftPhotos.push(f.name); });
      e.target.value=""; renderChips();
    });

    function resetAvaria(){
      $("#a_cntr").value=""; $("#a_origem").value="VISTORIA"; $("#a_sev").value="M√âDIA"; $("#a_status").value="ABERTA";
      $("#a_area").value="PORTAS"; $("#a_tipo").value="AMASSADO"; $("#a_desc").value="";
      avDraftPhotos=[]; renderChips();
    }
    function saveAvaria(){
      const cntr=$("#a_cntr").value.trim().toUpperCase();
      if(!cntr){ alert("Informe o CNTR."); return; }
      S.damages.unshift({
        id:uid("AVA"), cntr,
        origem:$("#a_origem").value, sev:$("#a_sev").value, status:$("#a_status").value,
        area:$("#a_area").value, tipo:$("#a_tipo").value, desc:$("#a_desc").value.trim(),
        photos:avDraftPhotos.slice(), createdAt:new Date().toISOString()
      });
      persist(); renderAvarias(); resetAvaria(); alert("Avaria salva (demo).");
    }
    function renderAvarias(){
      const fcntr=$("#a_fcntr").value.trim().toUpperCase();
      const fstatus=$("#a_fstatus").value;
      const fsev=$("#a_fsev").value;
      const forigem=$("#a_forigem").value;

      const list=S.damages
        .filter(x=>!fcntr||x.cntr.includes(fcntr))
        .filter(x=>!fstatus||x.status===fstatus)
        .filter(x=>!fsev||x.sev===fsev)
        .filter(x=>!forigem||x.origem===forigem)
        .sort((a,b)=>new Date(b.createdAt)-new Date(a.createdAt));

      const el=$("#a_list");
      if(!list.length){
        el.innerHTML=`<div class="item" style="cursor:default"><div style="color:rgba(71,85,105,.95)">Nenhum registro.</div><div class="mono">‚Äî</div></div>`;
        return;
      }

      el.innerHTML=list.map(x=>`
        <div class="item" data-id="${x.id}">
          <div>
            <div><b>${x.cntr}</b> <span class="mono" style="opacity:.70">‚Ä¢ ${x.id}</span></div>
            <div style="margin-top:6px; display:flex; gap:8px; flex-wrap:wrap;">
              ${tagSev(x.sev)} ${tagStatus(x.status)}
              <span class="tag"><span class="dot" style="background:rgba(15,23,42,.35)"></span>${x.area}</span>
              <span class="tag"><span class="dot" style="background:rgba(37,99,235,.85)"></span>${x.origem}</span>
              <span class="tag"><span class="dot" style="background:rgba(16,185,129,.85)"></span>üì∑ ${(x.photos?.length||0)} foto(s)</span>
            </div>
          </div>
          <div class="mono" style="opacity:.60">${fmt(x.createdAt)}</div>
        </div>`).join("");

      el.querySelectorAll(".item[data-id]").forEach(r=>r.addEventListener("click",()=>{
        const x=S.damages.find(z=>z.id===r.getAttribute("data-id"));
        alert(
          `Avaria ${x.id}\nCNTR: ${x.cntr}\nOrigem: ${x.origem}\nStatus: ${x.status}\nSeveridade: ${x.sev}\n` +
          `√Årea: ${x.area}\nTipo: ${x.tipo}\nFotos: ${(x.photos&&x.photos.length)?x.photos.join(", "):"‚Äî"}\n\nDescri√ß√£o:\n${x.desc||"‚Äî"}`
        );
      }));
    }

    $("#a_save").addEventListener("click", saveAvaria);
    $("#a_new").addEventListener("click", resetAvaria);
    $("#a_apply").addEventListener("click", renderAvarias);
    $("#a_clear").addEventListener("click", ()=>{ $("#a_fcntr").value=""; $("#a_fstatus").value=""; $("#a_fsev").value=""; $("#a_forigem").value=""; renderAvarias(); });

    // Seed/Reset
    $("#seed").addEventListener("click", ()=>{
      const now=Date.now();
      S.inspections=[
        {id:"INSP-20260105-151200",cntr:"ABCD1234567",tipo:"GATE IN",vinc:"CE 2026/000123",resp:"Inspetor 01",sev:"BAIXA",status:"ENCERRADA",desc:"Sem observa√ß√µes relevantes.",createdAt:new Date(now-3600e3).toISOString()},
        {id:"INSP-20260105-141020",cntr:"TGHU0099887",tipo:"TRANSFER√äNCIA",vinc:"OS TRF-44821",resp:"Inspetor 03",sev:"ALTA",status:"EM AN√ÅLISE",desc:"Portas desalinhadas. Recomendar hold e repair.",createdAt:new Date(now-8600e3).toISOString()},
      ];
      S.damages=[
        {id:"AVA-20260105-155500",cntr:"TGHU0099887",origem:"VISTORIA",sev:"ALTA",status:"EM AN√ÅLISE",area:"PORTAS",tipo:"DESALINHAMENTO",
         desc:"Gerado ap√≥s inspe√ß√£o. Avaliar hold + encaminhar repair.",photos:["doors_alignment.png","seal_area_zoom.jpg"],createdAt:new Date(now-2200e3).toISOString()}
      ];
      persist(); renderInspect(); renderAvarias(); alert("Demo populada.");
    });

    $("#reset").addEventListener("click", ()=>{
      localStorage.removeItem(KEY);
      S={inspections:[],damages:[]};
      persist(); resetInspect(); resetAvaria(); renderChips(); renderInspect(); renderAvarias(); alert("Reset conclu√≠do.");
    });

    // Init
    persist(); resetInspect(); resetAvaria(); renderChips();
    renderInspect(); renderAvarias(); setPage("inspect");
  </script>


</body></html>